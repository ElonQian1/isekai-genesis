# 🎮 地底末日卡牌游戏 - 设计文档

> 一款多人组队对战的 RPG 类 3D 卡牌游戏

---

## 🌍 世界观背景

在地底凶兽的无穷摧残下，人类面临末日生存的难题。留下的幸存者各自组成了**地区生存组织**，为了生存，各个地区组织在野外联合探索与绞杀凶兽获取生存资源的同时，还会暗中互相残杀，以获得最大化生存物料。

---

## ⚔️ 职业系统

游戏共有 **5 个职业**，每个职业都有**专属天赋**：

| 职业 | 图标 | 定位 | 专属天赋 | 天赋效果 |
|------|------|------|----------|----------|
| **骑士** | 🛡️ | 坦克/守护 | 不屈意志 | 生命<30%时获得50%减伤，持续3回合 |
| **剑士** | ⚔️ | 近战输出 | 剑气纵横 | 连续攻击同一目标，每次伤害+15%，最多3层 |
| **术士** | 🔮 | 魔法输出 | 暗影契约 | 施放魔法后，下次魔法伤害+25%，恢复10魔力 |
| **枪手** | 🔫 | 远程输出 | 致命精准 | 30%概率触发精准射击，150%伤害，无视30%防御 |
| **刺客** | 🗡️ | 爆发输出 | 暗影步 | 首次攻击必暴击，暴击伤害+50% |

---

## 🎲 玩法模式

### 1. 野外探索
- **单人/组队**：可个人或与相同组织的玩家组队
- **共同探索**：探索末日世界，收集资源
- **遭遇战**：随机遭遇凶兽和敌对组织

### 2. 小型 BOSS 副本
- **组队挑战**：同组织玩家组队共同对抗
- **难度递进**：从简单到困难多档难度
- **奖励丰厚**：击杀 BOSS 获取稀有装备和材料

### 3. 周本 BOSS（核心玩法）

#### 匹配机制
- **4 个组织**参与，每组织 **2 名玩家**
- 共 **8 人**共同对抗周本 BOSS

#### 战斗规则

```
┌─────────────────────────────────────────────────────────────┐
│                        周本 BOSS                            │
│                                                             │
│   💀 BOSS                                                   │
│   ├── 生命值条                                              │
│   ├── 怒气值条 ████████░░ 80%                               │
│   └── 攻击力: 基础值 × (1 + 复活次数 × 5%)                  │
│                                                             │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│   🔴 组织A      🔵 组织B      🟢 组织C      🟡 组织D         │
│   玩家1 玩家2   玩家1 玩家2   玩家1 玩家2   玩家1 玩家2       │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

#### 回合流程
1. **抽牌阶段**：每回合抽取手牌
2. **出牌阶段**：使用卡牌攻击 BOSS 或辅助队友
3. **嘲讽机制**：可使用卡牌让 BOSS 下回合攻击指定组织的玩家
4. **BOSS 回合**：BOSS 根据仇恨选择攻击目标

#### 怒气值机制
| 条件 | 效果 |
|------|------|
| 受到攻击 | 怒气值根据伤害数值增加 |
| 怒气值满 | BOSS 释放**全屏技能**，攻击**全体玩家** |

#### 胜利条件（核心机制）
```
⚠️ 关键规则：

当游戏回合内存在 > 1 个组织阵型的玩家时：
  └── BOSS 血条清空 → 不会死亡
  └── 以当前生命值的 50% 复活
  └── 攻击力增加 5%

当游戏回合内只剩 1 个组织阵型的玩家时：
  └── BOSS 血条清空 → 击败 BOSS！
  └── 该组织获得最终胜利
```

---

## 📈 成长系统

### 角色属性
- **经验值 (EXP)**：通过战斗和探索累积
- **等级 (LV)**：提升属性和解锁技能
- **装备**：武器、防具、饰品

### 属性类型
| 属性 | 简称 | 效果 |
|------|------|------|
| 力量 | STR | 物理攻击力 |
| 敏捷 | AGI | 暴击率、闪避率 |
| 智力 | INT | 魔法攻击力 |
| 精神 | SPI | 治疗量、魔法防御 |
| 体质 | VIT | 生命值上限 |

---

## 🎨 画面风格

### 3D 大世界
- **末日废墟风格**：破败的城市、地底洞穴、荒芜野外
- **动态天气**：雾霾、酸雨、暗夜
- **实时光影**：WebGPU 渲染，支持光追效果

### 战斗场景
- **卡牌 3D 展示**：精美的卡牌翻转和攻击动画
- **技能特效**：粒子系统实现华丽技能效果
- **BOSS 建模**：巨型凶兽的 3D 模型和动作

---

## 🛠️ 技术栈

| 层级 | 技术 | 说明 |
|------|------|------|
| 前端渲染 | Babylon.js + WebGPU | 3D 渲染引擎 |
| 游戏逻辑 | Rust → WASM | 高性能逻辑处理 |
| 后端服务 | Rust + Axum | 高并发服务器 |
| 数据库 | PostgreSQL | 玩家数据存储 |
| 通信 | WebSocket | 实时对战通信 |

---

## 📅 开发路线

### 阶段一：基础框架 ✅
- [x] Rust 项目结构
- [x] 职业系统
- [x] 天赋系统
- [x] 卡牌系统

### 阶段二：核心玩法 🔄
- [x] BOSS 战斗系统
- [x] 怒气值机制
- [ ] 组织对抗逻辑
- [ ] 复活与增强机制

### 阶段三：3D 世界 📋
- [ ] 大世界场景
- [ ] 野外探索
- [ ] 战斗特效
- [ ] 角色模型

### 阶段四：上线部署 📋
- [ ] 服务器优化
- [ ] 负载均衡
- [ ] 数据备份

